<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Consolidate window sizes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for mergeWindowsList {csaw}"><tr><td>mergeWindowsList {csaw}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Consolidate window sizes</h2>

<h3>Description</h3>

<p>Consolidate windows of different sizes into a common set of regions.</p>


<h3>Usage</h3>

<pre>
mergeWindowsList(ranges.list, tol, ...)

findOverlapsList(ranges.list, regions, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>ranges.list</code></td>
<td>
<p>A list of <a href="../../SummarizedExperiment/html/RangedSummarizedExperiment-class.html">RangedSummarizedExperiment</a> and/or <a href="../../GenomicRanges/html/GRanges-class.html">GRanges</a> objects.</p>
</td></tr>
<tr valign="top"><td><code>tol</code></td>
<td>
<p>An integer scalar specifying the tolerance to use in <code><a href="../../csaw/help/mergeWindows.html">mergeWindows</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>For <code>mergeWindowsList</code>, further arguments to pass to <code><a href="../../csaw/help/mergeWindows.html">mergeWindows</a></code>.
</p>
<p>For <code>findOverlapsList</code>, further arguments to pass to <code><a href="../../DEXSeq/html/methods-gr.html">findOverlaps</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>regions</code></td>
<td>
<p>A <a href="../../GenomicRanges/html/GRanges-class.html">GRanges</a> object specifying reference regions of interest for overlapping with windows.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DB analyses with <span class="pkg">csaw</span> can be repeated using windows of different sizes to
provide comprehensive detection of DB at a range of spatial resolutions.
This function merges together those sets of windows of differing sizes, 
typically generated by multiple calls to <code><a href="../../csaw/help/windowCounts.html">windowCounts</a></code> using different <code>width</code> values.
For <code>mergeWindowsList</code>, windows of all sizes are clustered together through <code><a href="../../csaw/help/mergeWindows.html">mergeWindows</a></code>.
For <code>findOverlapsList</code>, windows of all sizes are overlapped with <code>ref</code> using <code><a href="../../DEXSeq/html/methods-gr.html">findOverlaps</a></code>.
</p>
<p>The aim is to pass the output of this function to <code><a href="../../csaw/help/combineTests.html">combineTests</a></code> or <code><a href="../../csaw/help/combineOverlaps.html">combineOverlaps</a></code>.
This takes the statistical machinery used to combine p-values across windows for a cluster or reference region,
and recycles it to provide a rigorous method for consolidating statistics across multiple analyses with different window sizes.
However, it requires some care to balance the contribution of analyses with different window sizes to the combined p-value.
Otherwise, analyses with many small windows will dominate the calculation for each cluster or reference region.
</p>
<p>To compensate for this effect, both functions weight each window's contribution to a cluster or region.
The weight is inversely proportional to the number of windows of the same size in the same cluster or region.
For <code>mergeWindowsList</code>, this yields a weight for each window,
while for <code>findOverlapsList</code>, this yields a weight for each overlap.
Application of those weights in <code><a href="../../csaw/help/combineTests.html">combineTests</a></code> and related functions ensures that the combined p-value 
is not dominated by numerous small windows within a cluster.
</p>


<h3>Value</h3>

<p><code>mergeWindowsList</code> returns a named list containing:
</p>

<dl>
<dt><code>ranges</code>:</dt><dd><p>A <a href="../../GenomicRanges/html/GRanges-class.html">GRanges</a> object containing the concatenated intervals from all elements of <code>x</code>.
The element-wise metadata of this GRanges contains <code>origin</code>, 
an integer field specifying the index of <code>x</code> from which each interval was obtained.</p>
</dd>
<dt><code>ids</code>:</dt><dd><p>An integer vector of length equal to <code>ranges</code>. 
This specifies the cluster (i.e., entry of <code>merged</code>) to which each interval in <code>ranges</code> was assigned.</p>
</dd>
<dt><code>regions</code>:</dt><dd><p>A GRanges object containing the genomic coordinates of the clusters of merged windows,
as computed by <code><a href="../../csaw/help/mergeWindows.html">mergeWindows</a></code>.</p>
</dd>
<dt><code>weights</code>:</dt><dd><p>An numeric vector of length equal to <code>ranges</code>, specifying the weight of each interval.</p>
</dd>
</dl>

<p><code>findOverlapsList</code> returns a named list containing:
</p>

<dl>
<dt><code>ranges</code>:</dt><dd><p>A <a href="../../GenomicRanges/html/GRanges-class.html">GRanges</a> object containing the concatenated intervals from all elements of <code>x</code>.
The element-wise metadata of this object contains the integer field <code>origin</code>, as described above.</p>
</dd>
<dt><code>olap</code>:</dt><dd><p>A <a href="../../S4Vectors/html/Hits-class.html">Hits</a> object containing the overlaps between <code>ref</code> (query) and <code>ranges</code> (subject).</p>
</dd>
<dt><code>weights</code>:</dt><dd><p>A numeric vector of length equal to <code>olap</code>, containing the weight of each overlap.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Aaron Lun
</p>


<h3>See Also</h3>

<p><code><a href="../../csaw/help/mergeWindows.html">mergeWindows</a></code>, for the functionality behind <code>mergeWindowsList</code>.
</p>
<p><code><a href="../../DEXSeq/html/methods-gr.html">findOverlaps</a></code>, for the functionality behind <code>findOverlapsList</code>.
</p>


<h3>Examples</h3>

<pre>
bamFiles &lt;- system.file("exdata", c("rep1.bam", "rep2.bam"), package="csaw")
low &lt;- windowCounts(bamFiles, width=1, filter=1)
med &lt;- windowCounts(bamFiles, width=100, filter=1)
high &lt;- windowCounts(bamFiles, width=500, filter=1)

cons &lt;- mergeWindowsList(list(low, med, high), tol=100)
cons$ranges
cons$merged

of.interest &lt;- GRanges(c('chrA', 'chrA', 'chrB', 'chrC'), 
    IRanges(c(1, 500, 100, 1000), c(200, 1000, 700, 1500)))
cons &lt;- findOverlapsList(list(low, med, high), regions=of.interest)
cons$ranges
cons$olap
</pre>

<hr /><div style="text-align: center;">[Package <em>csaw</em> version 1.26.0 <a href="00Index.html">Index</a>]</div>
</body></html>
